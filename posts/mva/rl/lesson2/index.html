<!doctype html><html>
<head>
<title>Reinforcement learning, lesson 2</title>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta http-equiv=x-ua-compatible content="ie=edge">
<link rel=stylesheet href=/css/bootstrap.min.css>
<link rel=stylesheet href=/css/layouts/main.css>
<link rel=stylesheet href=/css/navigators/navbar.css>
<link rel=stylesheet href=/css/plyr.css>
<link rel=stylesheet href=/css/flag-icon.min.css>
<link href="https://fonts.googleapis.com/css2?family=Muli:wght@300;400;500;600" rel=stylesheet>
<link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css>
<link rel=icon type=image/png href=/images/site/favicon3_hu62e62282d1df9a6f522c194700ff0a75_33785_42x0_resize_box_3.png>
<meta property="og:title" content="Reinforcement learning, lesson 2">
<meta property="og:description" content="Sample post with multiple images, embedded video ect.">
<meta property="og:type" content="article">
<meta property="og:url" content="https://arthurzucker.github.io/posts/mva/rl/lesson2/"><meta property="article:section" content="posts">
<meta property="article:published_time" content="2021-10-18T00:00:00+00:00">
<meta property="article:modified_time" content="2021-10-18T00:00:00+00:00">
<meta name=description content="Sample post with multiple images, embedded video ect.">
<link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/atom-one-dark.min.css>
<link rel=stylesheet href=/css/layouts/single.css>
<link rel=stylesheet href=/css/navigators/sidebar.css>
<link rel=stylesheet href=/css/style.css>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-YRJ694EF5C"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','G-YRJ694EF5C',{anonymize_ip:!1})}</script>
</head>
<body data-spy=scroll data-target=#TableOfContents data-offset=80>
<div class="container-fluid bg-dimmed wrapper">
<nav class="navbar navbar-expand-xl top-navbar final-navbar shadow">
<div class=container>
<button class="navbar-toggler navbar-light" id=sidebar-toggler type=button onclick=toggleSidebar()>
<span class=navbar-toggler-icon></span>
</button>
<a class=navbar-brand href=/>
<img src=/images/site/favicon3_hu62e62282d1df9a6f522c194700ff0a75_33785_42x0_resize_box_3.png alt=Logo>
Arthur Zucker's Portfolio</a>
<button class="navbar-toggler navbar-light" id=toc-toggler type=button onclick=toggleTOC()>
<span class=navbar-toggler-icon></span>
</button>
<div class="collapse navbar-collapse lang-selector" id=top-nav-items>
<ul class="navbar-nav ml-auto">
</ul>
</div>
</div>
<img src=/images/site/favicon3_hu62e62282d1df9a6f522c194700ff0a75_33785_42x0_resize_box_3.png class=d-none id=main-logo alt=Logo>
<img src=/images/site/favicon4_hu5db1c7af89e12ca8c711bcc33bb3007c_15810_42x0_resize_box_3.png class=d-none id=inverted-logo alt="Inverted Logo">
</nav>
<section class=sidebar-section id=sidebar-section>
<div class=sidebar-holder>
<div class=sidebar id=sidebar>
<form class=mx-auto method=get action=/search>
<input type=text name=keyword placeholder=Search data-search id=search-box>
</form>
<div class=sidebar-tree>
<ul class=tree id=tree>
<li id=list-heading><a href=/posts data-filter=all>Posts</a></li>
<div class=subtree>
<li>
<i class="fas fa-plus-circle"></i><a href=/posts/flying-foxes-study/>Passive Acoustic Monitoring Using AI</a>
<ul>
<li>
<i class="fas fa-plus-circle"></i><a href=/posts/flying-foxes-study/ai/>Deep Learning pipeline</a>
<ul>
<li><a href=/posts/flying-foxes-study/ai/aed/ title="Audio Event Detection">Audio Event Detection</a></li>
<li><a href=/posts/flying-foxes-study/ai/speaker/ title="Speaker Recognition">Speaker Recognition</a></li>
</ul>
</li>
<li><a href=/posts/flying-foxes-study/ecology/ title=Ecology>Ecology</a></li>
</ul>
</li>
<li>
<i class="fas fa-plus-circle"></i><a href=/posts/projects/>Projects</a>
<ul>
<li><a href=/posts/projects/safran/ title="Semantic Segmentation for cars">Semantic Segmentation for cars</a></li>
<li><a href=/posts/projects/clusti/ title="Table Structure Recognition">Table Structure Recognition</a></li>
</ul>
</li>
<li>
<i class="fas fa-minus-circle"></i><a class=active href=/posts/mva/>MVA Courses</a>
<ul class=active>
<li>
<i class="fas fa-plus-circle"></i><a href=/posts/mva/recvis/>Computer Vision & Object Recognition</a>
<ul>
<li><a href=/posts/mva/recvis/lesson1/ title="Lesson 1">Lesson 1</a></li>
<li><a href=/posts/mva/recvis/lesson3/ title="Lesson 3">Lesson 3</a></li>
</ul>
</li>
<li>
<i class="fas fa-plus-circle"></i><a href=/posts/mva/deeplearning/>Deep Learning</a>
<ul>
<li><a href=/posts/mva/deeplearning/lesson2/ title="Lesson 2">Lesson 2</a></li>
</ul>
</li>
<li>
<i class="fas fa-minus-circle"></i><a class=active href=/posts/mva/rl/>Reinforcement Learning</a>
<ul class=active>
<li><a href=/posts/mva/rl/lesson1/ title="Lesson 1">Lesson 1</a></li>
<li><a class=active href=/posts/mva/rl/lesson2/ title="Lesson 2">Lesson 2</a></li>
</ul>
</li>
</ul>
</li>
<li><a href=/posts/backward/ title="Backward propagation">Backward propagation</a></li>
</div>
</ul>
</div>
</div>
</div>
</section>
<section class=content-section id=content-section>
<div class=content>
<div class="container p-0 read-area">
<div class="hero-area col-sm-12" id=hero-area style=background-image:url(https://arthurzucker.github.io/posts/mva/rl/lesson2/images/path.png)>
</div>
<div class=page-content>
<div class="author-profile ml-auto align-self-lg-center">
<img class=rounded-circle src=/images/author/me_hue0c31f5a221a4dac786736a317c9bf63_45873_120x120_fit_q75_box.jpg alt="Author Image">
<h5 class=author-name>Arthur Zucker</h5>
<p>October 18, 2021</p>
</div>
<div class=title>
<h1>Reinforcement learning, lesson 2</h1>
</div>
<div class=taxonomy-terms>
<ul>
<li class=rounded><a href=/tags/mva class="btn, btn-sm">MVA</a></li>
<li class=rounded><a href=/tags/reinforcement-learning class="btn, btn-sm">Reinforcement Learning</a></li>
<li class=rounded><a href=/tags/english class="btn, btn-sm">English</a></li>
</ul>
</div>
<div class=post-content id=post-content>
<p>This post sums up the content of the lesson nÂ°2 of RL on dynamic programming</p>
<hr>
<style>r{color:Red}o{color:Orange}g{color:Green}b{color:Blue}</style>
<h1 id=solving-the-infinite-horizon-discounted-mdps>Solving the infinite-Horizon discounted MDPs</h1>
<p>The problem we have to solve is the following :
$$
\begin{align*}
\max <em>{\pi} V^{\pi}\left(s</em>{0}\right)= & \
= & \max <em>{\pi} \mathbb{E}\left[r\left(s</em>{0}, d_{0}\left(a_{0} \mid s_{0}\right)\right)+\gamma r\left(s_{1}, d_{1}\left(a_{1} \mid s_{0}, s_{1}\right)\right)+\gamma^{2} r\left(s_{2}, d_{2}\left(a_{2} \mid s_{0}, s_{1}, s_{2}\right)\right)+\ldots\right] \
=&\mathbb{E}\left[\sum_{t=0}^{\infty} \gamma^{t} r\left(s_{t}, a_{t}\right) \mid a_{t} \sim d_{t}\left(\cdot \mid h_{t}\right)\right]
\end{align*}
$$</p>
<h2 id=reducing-the-search-space->Reducing the search space :</h2>
<h3 id=history-based-to-markov-decision>History based to markov decision</h3>
<div class="alert alert-danger">
<strong><p>Theorem (Bertsekas [2007])</p>
<p>Consider an MDP with $|A|&lt;\infty$ and an initial distribution $\beta$ over states such that $|{s \in S: \beta(s)>0}|&lt;\infty .$ For any policy $\pi$, let
$$
p_{t}^{\pi}(s, a)=\mathbb{P}\left[S_{t}=s, A_{t}=a\right] ; \quad p_{t}^{\pi}(s)=\mathbb{P}\left[S_{t}=s\right]
$$
Then for any history-based policy $\pi$ there exists a Markov policy $\bar{\pi}$ such that
$$
p_{t}^{\bar{\pi}}(s, a)=p_{t}^{\pi}(s, a) ; \quad p_{t}^{\bar{\pi}}(s)=p_{t}^{\pi}(s)
$$
for any $s \in S, a \in A$ and $t \in \mathbb{N}^{+}$</p>
</strong>
</div>
<p>Introduced the Discounted Occupancy measure but I don&rsquo;t know why.</p>
<h3 id=non-stationary-to-stationary>Non-stationary to stationary</h3>
<div class="alert alert-danger">
<strong>Theorem (Bertsekas [2007])
Consider an MDP with $|A|&lt;\infty$ and an initial distribution $\beta$ over states such that $|{s \in S: \beta(s)>0}|&lt;\infty$
Then for any non-stationary policy $\pi$ there exists a stationary policy $\bar{\pi}$ such that
$$
\rho_{\gamma}^{\bar{\pi}}(s, a)=\rho_{\gamma}^{\pi}(s, a) ; \quad \rho_{\gamma}^{\bar{\pi}}(s)=\rho_{\gamma}^{\pi}(s)
$$
for any $s \in S, a \in A$ and $t \in \mathbb{N}^{+}$</strong>
</div>
<h2 id=simplifying-the-value-function>Simplifying the value function</h2>
<h2 id=from-stochastic-to-deterministic-decision-rules>From stochastic to deterministic decision rules</h2>
<p>Conclusion: we can now focus on stationary policies with deterministic markov decision rules.</p>
<h1 id=solving-finite-horizon-mdps>Solving Finite-Horizon MDPs</h1>
<h1 id=solving-infinite-horizon-undiscounted-mdps>Solving Infinite-Horizon Undiscounted MDPs</h1>
<h1 id=summary>Summary</h1>
<h2 id=example>Example</h2>
<p>Let&rsquo;s apply the notions to a simple example. Let&rsquo;s consider the following model :</p>
<img src=images/example_mdp1.png alt="Example of a markov decision process" class=center>
</div>
<div class="row pl-3 pr-3">
<div class="col-md-6 share-buttons">
<strong>Share on:</strong>
<a class="btn btn-sm facebook-btn" href="https://www.facebook.com/sharer.php?u=https%3a%2f%2farthurzucker.github.io%2fposts%2fmva%2frl%2flesson2%2f" target=_blank>
<i class="fab fa-facebook"></i>
</a>
<a class="btn btn-sm twitter-btn" href="https://twitter.com/share?url=https%3a%2f%2farthurzucker.github.io%2fposts%2fmva%2frl%2flesson2%2f&text=Reinforcement%20learning%2c%20lesson%202&via=Arthur%20Zucker%27s%20Portfolio" target=_blank>
<i class="fab fa-twitter"></i>
</a>
<a class="btn btn-sm reddit-btn" href="https://reddit.com/submit?url=https%3a%2f%2farthurzucker.github.io%2fposts%2fmva%2frl%2flesson2%2f&title=Reinforcement%20learning%2c%20lesson%202" target=_blank>
<i class="fab fa-reddit"></i>
</a>
<a class="btn btn-sm linkedin-btn" href="https://www.linkedin.com/shareArticle?url=https%3a%2f%2farthurzucker.github.io%2fposts%2fmva%2frl%2flesson2%2f&title=Reinforcement%20learning%2c%20lesson%202" target=_blank>
<i class="fab fa-linkedin"></i>
</a>
<a class="btn btn-sm whatsapp-btn" href="https://api.whatsapp.com/send?text=Reinforcement%20learning%2c%20lesson%202 https%3a%2f%2farthurzucker.github.io%2fposts%2fmva%2frl%2flesson2%2f" target=_blank>
<i class="fab fa-whatsapp"></i>
</a>
<a class="btn btn-sm email-btn" href="mailto:?subject=Reinforcement%20learning%2c%20lesson%202&body=https%3a%2f%2farthurzucker.github.io%2fposts%2fmva%2frl%2flesson2%2f" target=_blank>
<i class="fas fa-envelope-open-text"></i>
</a>
</div>
<div class="col-md-6 btn-improve-page">
<a href=https://github.com/ArthurZucker/ArthurZucker.github.io/edit/main/content/posts/MVA/RL/lesson2/index.md title="Improve this page" target=_blank rel=noopener>
<i class="fas fa-code-branch"></i>
Improve this page
</a>
</div>
</div>
<hr>
<div class="row next-prev-navigator">
<div class="col-md-6 previous-article">
<a href=/posts/mva/rl/lesson1/ title="Reinforcement learning, lesson 1" class="btn btn-outline-info">
<div><i class="fas fa-chevron-circle-left"></i> Prev</div>
<div class=next-prev-text>Reinforcement learning, lesson 1</div>
</a>
</div>
<div class="col-md-6 next-article">
<a href=/posts/backward/ title="Backward propagation using matrix notations" class="btn btn-outline-info">
<div>Next <i class="fas fa-chevron-circle-right"></i></div>
<div class=next-prev-text>Backward propagation using matrix notations</div>
</a>
</div>
</div>
<hr>
</div>
</div>
</div>
<a id=scroll-to-top class=btn><i class="fas fa-chevron-circle-up"></i></a>
</section>
<section class=toc-section id=toc-section>
<div class=toc-holder>
<h5 class="text-center pl-3">Table of Contents</h5>
<hr>
<div class=toc>
<nav id=TableOfContents>
<ul>
<li><a href=#reducing-the-search-space->Reducing the search space :</a>
<ul>
<li><a href=#history-based-to-markov-decision>History based to markov decision</a></li>
<li><a href=#non-stationary-to-stationary>Non-stationary to stationary</a></li>
</ul>
</li>
<li><a href=#simplifying-the-value-function>Simplifying the value function</a></li>
<li><a href=#from-stochastic-to-deterministic-decision-rules>From stochastic to deterministic decision rules</a></li>
</ul>
<ul>
<li><a href=#example>Example</a></li>
</ul>
</nav>
</div>
</div>
</section>
</div>
<footer class="container-fluid text-center align-content-center footer pb-2">
<div class="container pt-5">
<div class="row text-left">
<div class="col-md-4 col-sm-12">
<h5>Navigation</h5>
<ul>
<li class=nav-item>
<a class=smooth-scroll href=/#about>About</a>
</li>
<li class=nav-item>
<a class=smooth-scroll href=/#skills>Skills</a>
</li>
<li class=nav-item>
<a class=smooth-scroll href=/#experiences>Experiences</a>
</li>
<li class=nav-item>
<a class=smooth-scroll href=/#education>Education</a>
</li>
<li class=nav-item>
<a class=smooth-scroll href=/#projects>Projects</a>
</li>
<li class=nav-item>
<a class=smooth-scroll href=/#recent-posts>Recent Posts</a>
</li>
<li class=nav-item>
<a class=smooth-scroll href=/#accomplishments>Accomplishments</a>
</li>
<li class=nav-item>
<a class=smooth-scroll href=/#achievements>Achievements</a>
</li>
</ul>
</div>
<div class="col-md-4 col-sm-12">
<h5>Contact me:</h5>
<ul>
<li><span>Email: </span> <span>arthur.zucker@ens-paris-saclay.fr</span></li>
</ul>
</div>
</div>
</div>
</footer>
<script type=text/javascript src=/js/jquery-3.4.1.min.js></script>
<script type=text/javascript src=/js/popper.min.js></script>
<script type=text/javascript src=/js/bootstrap.min.js></script>
<script type=text/javascript src=/js/navbar.js></script>
<script type=text/javascript src=/js/plyr.js></script>
<script type=text/javascript src=/js/main.js></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/highlight.min.js></script>
<script src=/js/single.js></script>
<script>hljs.initHighlightingOnLoad()</script>
<script>window.MathJax={tex:{inlineMath:[['$','$']]},options:{enableMenu:!0}}</script>
<script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js></script>
<style>mjx-container.MathJax[display=inline]{font-size:150%!important}mjx-container.MathJax[display=true]{text-align:left!important}@media screen and (min-width:600px){mjx-container.MathJax[display=true]{padding-left:2rem}}</style>
<link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css integrity=sha384-zB1R0rpPzHqg7Kpt0Aljp8JPLqbXI3bhnPWROx27a9N0Ll6ZP/+DiW/UqRcLbRjq crossorigin=anonymous>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js integrity=sha384-y23I5Q6l+B6vatafAwxRu/0oK/79VlbSz7Q9aiSZUvyWYIYsd+qj+o24G5ZU2zJz crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js integrity=sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI crossorigin=anonymous onload=renderMathInElement(document.body)></script>
</body>
</html>